<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.board">
	<resultMap id="boardResult" type="boardVO">
		<result property="bno" column="bno" />
		<result property="title" column="title" />
		<result property="nickname" column="nickname" />
		<result property="credate" column="credate" />
		<result property="content" column="content" />
		<result property="pin" column="pin" />
		<result property="category" column="category" />
		<result property="hit" column="hit" />
	</resultMap>

<!-- 게시글 목록 -->
<select id="lists" resultMap="boardResult">
	<![CDATA[
		select bno, title, nickname, credate, pin, category, hit from
		(
			select bno, title, nickname, credate, pin, category, hit,
				row_number() over(order by bno desc) as rnum
			from board )lists
		where rnum between #{rowStart} and #{rowEnd}
		order by bno desc
	]]>
</select>
<!-- 게시글 목록(자유)-->
<select id="free" resultMap="boardResult">
	<![CDATA[
		select bno, title, nickname, credate, pin, category, hit from
		(
			select bno, title, nickname, credate, pin, category, hit,
				row_number() over(order by bno desc) as rnum
			from board 
				where category = 1)free
		where rnum between #{rowStart} and #{rowEnd}
		order by bno desc
	]]>

</select>
<!-- 게시글 목록(질문) -->
<select id="qna" resultMap="boardResult">
	<![CDATA[
		select bno, title, nickname, credate, pin, category, hit from
		(
			select bno, title, nickname, credate, pin, category, hit,
				row_number() over(order by bno desc) as rnum
			from board 
				where category = 2)qna
		where rnum between #{rowStart} and #{rowEnd}
		order by bno desc
	]]>
</select>
<!-- 게시글 목록(공략) -->
<select id="tip" resultMap="boardResult">
	<![CDATA[
		select bno, title, nickname, credate, pin, category, hit from
		(
			select bno, title, nickname, credate, pin, category, hit,
				row_number() over(order by bno desc) as rnum
			from board
				where category = 3)tip
		where rnum between #{rowStart} and #{rowEnd}
		order by bno desc
	]]>
</select>
<!-- 게시글 목록(자랑) -->
<select id="brag" resultMap="boardResult">
	<![CDATA[
		select bno, title, nickname, credate, pin, category, hit from
		(
			select bno, title, nickname, credate, pin, category, hit,
				row_number() over(order by bno desc) as rnum
			from board 
				where category = 4)brag
		where rnum between #{rowStart} and #{rowEnd}
		order by bno desc
	]]>
</select>

<!-- 게시글 작성 -->
<insert id="register">
	<![CDATA[
		insert into board(bno, title , nickname , credate , content , pin , category , hit)
		values((select nvl(max(bno)+1,1) from board), #{title} , #{nickname} , sysdate , #{content} , #{pin} , #{category} , #{hit})
	]]>
</insert>

<!-- 상세보기 -->
<select id="detail" parameterType="int" resultMap="boardResult">
	<![CDATA[
		select * from board
		where bno = #{bno}
	]]>
</select>

<!-- 조회수 -->
<update id="UpdateHit">
	<![CDATA[
		update board
		set hit = hit+1
		where bno = #{bno}		
	]]>
</update>

<!-- 삭제 -->
<delete id="remove">
	<![CDATA[
		delete from board
		where bno = #{bno}
	]]>
</delete>

<!-- 수정 -->
<update id="modify">
	<![CDATA[
		update board
		set title = #{title} , content = #{content} , category = #{category}
		where bno = #{bno}
	]]>
</update>

<!-- 총 게시글 갯수 -->
<select id="countList" resultType="int">
	<![CDATA[
		select count(*)
		from board
	]]>
</select>
</mapper>